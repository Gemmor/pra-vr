<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Interacción con lámpara</title>
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-look-at-component@0.8.0/dist/aframe-look-at-component.min.js"></script>
  </head>
  <body>
    <a-scene raycaster="objects: .clickable" cursor="rayOrigin: mouse; fuse: false">
      <a-assets>
        <img id="livingRoomTexture" src="Recursos2/livingRoom2.jpg">
        <a-asset-item id="lamp-obj" src="Recursos2/ZAHA LIGHT floor lamp2.obj"></a-asset-item>
      </a-assets>

      <a-sky src="#livingRoomTexture"></a-sky>

      <!-- Lámpara y zona clic -->
      <a-entity position="-1.4 -0.1 -3.5" scale="1 1 1">
        <a-entity obj-model="obj: #lamp-obj"></a-entity>

        <!-- Hitbox -->
        <a-box id="lampara"
               position="0 0.7 0"
               width="0.5"
               height="1.4"
               depth="0.5"
               color="#ff0000"
               opacity="0"
               class="clickable">
        </a-box>
      </a-entity>

      <!-- Botones -->
      <a-circle id="boton-info"
                color="#20204d"
                look-at="#cameraTarget"
                position="-1.4 1.6 -3.5"
                radius="0.25"
                visible="false"
                class="clickable"
                text="value: Informacio; align: center; color: white; width: 2.1">
      </a-circle>

      <a-circle id="boton-consejo"
                color="#2196F3"
                look-at="#cameraTarget"
                position="-2 1.6 -3.5"
                radius="0.25"
                visible="false"
                class="clickable"
                text="value: Consell; align: center; color: white; width: 2.3">
      </a-circle>

      <a-circle id="boton-accion"
                color="#f44336"
                look-at="#cameraTarget"
                position="-0.8 1.6 -3.5"
                radius="0.25"
                visible="false"
                class="clickable"
                text="value: Accio; align: center; color: white; width: 2.3">
      </a-circle>

      <!-- Fondo del texto (inicialmente oculto) -->
      <a-plane id="fondo-texto"
              rotation="0 30 0" 
               position="-1.5 1 -1.99"
               width="1"
               height="0.5"
               color="#ffffff"
               opacity="0.8"
               visible="false">
      </a-plane>

      <!-- Texto -->
      <a-text id="resultado"
              rotation="0 30 0" 
              position="-1.5 1 -1.98"
              value=""
              color="#000"
              align="center"
              width="1.5">
      </a-text>

      <!-- Cámara y cursor -->
      <a-entity id="cameraTarget">
        <a-camera>
          <a-cursor fuse="false" color="#66ffff"></a-cursor>
        </a-camera>
      </a-entity>
    </a-scene>

    <script>
      const lampara = document.querySelector('#lampara');
      const botonInfo = document.querySelector('#boton-info');
      const botonConsejo = document.querySelector('#boton-consejo');
      const botonAccion = document.querySelector('#boton-accion');
      const resultado = document.querySelector('#resultado');
      const fondoTexto = document.querySelector('#fondo-texto');

      lampara.addEventListener('click', () => {
        console.log("Lámpara clicada");
        botonInfo.setAttribute('visible', true);
        botonConsejo.setAttribute('visible', true);
        botonAccion.setAttribute('visible', true);
      });

      botonInfo.addEventListener('click', () => {
        resultado.setAttribute('value', 'Aquesta llum te un \nconsum de 60W.\n Es un gast excessiu.');
        fondoTexto.setAttribute('visible', true);
      });

      botonConsejo.addEventListener('click', () => {
        resultado.setAttribute('value', 'Utilitza una bombeta \nLED de 10W.');
        fondoTexto.setAttribute('visible', true);
      });

      botonAccion.addEventListener('click', () => {
        resultado.setAttribute('value', 'Comprar bombeta LED.');
        fondoTexto.setAttribute('visible', true);
      });
      
    </script>
  </body>
</html>
